/* empty css             *//* empty css                 *//* empty css                  */import{d as L,u as S,a as P,b as U,r as c,c as j,o as b,e as y,f as s,w as t,g as o,h as a,t as V,i as E,j as $,F as K,k as I,l as M,m as Y,E as R,n as G}from"./index-7a753478.js";import{E as H}from"./el-card-d5a120bc.js";import{E as z,_ as D}from"./_plugin-vue_export-helper-4445a987.js";import{E as J,a as O,b as Q,c as W}from"./index-a6bfc29c.js";import"./event-9519ab40.js";import"./refs-08e124bd.js";const X={key:0,class:"debug-auth"},Z={style:{display:"flex","justify-content":"space-between","align-items":"center"}},h={class:"debug-info"},ee={class:"debug-actions"},le={key:1,class:"debug-trigger"},oe=L({__name:"DebugAuth",setup(T){const x=S();P();const i=U(),p=c(!1),_=j(()=>localStorage.getItem("token")),d=()=>{location.reload()},u=()=>{i.logout(),localStorage.removeItem("token"),x.push("/login")},v=()=>{x.push("/dashboard")};return(w,l)=>{const g=z,A=H;return b(),y(K,null,[p.value?(b(),y("div",X,[s(A,null,{header:t(()=>[o("div",Z,[l[3]||(l[3]=o("span",null,"认证状态调试",-1)),s(g,{type:"text",onClick:l[0]||(l[0]=k=>p.value=!1)},{default:t(()=>l[2]||(l[2]=[a("×")])),_:1,__:[2]})])]),default:t(()=>[o("div",h,[o("p",null,[l[4]||(l[4]=o("strong",null,"当前路由:",-1)),a(" "+V(w.$route.path),1)]),o("p",null,[l[5]||(l[5]=o("strong",null,"认证状态:",-1)),a(" "+V(E(i).isAuthenticated?"已认证":"未认证"),1)]),o("p",null,[l[6]||(l[6]=o("strong",null,"Token存在:",-1)),a(" "+V(E(i).token?"是":"否"),1)]),o("p",null,[l[7]||(l[7]=o("strong",null,"用户信息:",-1)),a(" "+V(E(i).user?E(i).user.username:"无"),1)]),o("p",null,[l[8]||(l[8]=o("strong",null,"LocalStorage Token:",-1)),a(" "+V(_.value?"存在":"不存在"),1)]),o("div",ee,[s(g,{size:"small",onClick:d},{default:t(()=>l[9]||(l[9]=[a("刷新认证状态")])),_:1,__:[9]}),s(g,{size:"small",onClick:u},{default:t(()=>l[10]||(l[10]=[a("清除认证")])),_:1,__:[10]}),s(g,{size:"small",onClick:v},{default:t(()=>l[11]||(l[11]=[a("跳转仪表盘")])),_:1,__:[11]})])])]),_:1})])):$("",!0),p.value?$("",!0):(b(),y("div",le,[s(g,{type:"primary",size:"small",circle:"",onClick:l[1]||(l[1]=k=>p.value=!0),title:"显示调试信息"},{default:t(()=>l[12]||(l[12]=[a(" 🔍 ")])),_:1,__:[12]})]))],64)}}});const se=D(oe,[["__scopeId","data-v-605a9943"]]),te={class:"login-container"},re={class:"login-wrapper"},ae={class:"login-form-container cyber-container"},ne={key:0},ue={key:1},ie={class:"login-footer"},de={class:"dialog-footer"},me=L({__name:"Login",setup(T){const x=S(),i=U(),p=c(),_=c(),d=I({username:"admin123",password:"admin123"}),u=I({username:"",email:"",full_name:"",password:""}),v=c(!1),w=c(!1),l=c(!1),g={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}]},A={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于 6 个字符",trigger:"blur"}]},k=async()=>{var m,e;if(p.value)try{await p.value.validate(),v.value=!0,console.log("开始登录流程..."),await i.login(d),console.log("登录成功，认证状态:",i.isAuthenticated),console.log("Token:",i.token),R.success("登录成功"),await new Promise(n=>setTimeout(n,200)),console.log("准备跳转..."),await x.replace("/dashboard"),console.log("跳转完成")}catch(n){console.error("Login error:",n),R.error(((e=(m=n.response)==null?void 0:m.data)==null?void 0:e.detail)||"登录失败")}finally{v.value=!1}},q=async()=>{var m,e;if(_.value)try{await _.value.validate(),w.value=!0,await G.register(u),R.success("注册成功，请登录"),l.value=!1,d.username=u.username}catch(n){console.error("Register error:",n),R.error(((e=(m=n.response)==null?void 0:m.data)==null?void 0:e.detail)||"注册失败")}finally{w.value=!1}},B=()=>{var m;l.value=!1,(m=_.value)==null||m.resetFields()};return(m,e)=>{const n=Q,f=W,C=z,F=J,N=O;return b(),y("div",te,[s(se),e[16]||(e[16]=o("div",{class:"particles"},null,-1)),o("div",re,[o("div",ae,[e[13]||(e[13]=o("div",{class:"login-header"},[o("h1",{class:"login-title neon-text"},"⚡ CYBER API"),o("p",{class:"login-subtitle typewriter"},"下一代API测试控制中心"),o("div",{class:"subtitle-glow"})],-1)),s(F,{ref_key:"loginFormRef",ref:p,model:d,rules:g,class:"login-form",onSubmit:M(k,["prevent"])},{default:t(()=>[s(f,{prop:"username"},{default:t(()=>[s(n,{modelValue:d.username,"onUpdate:modelValue":e[0]||(e[0]=r=>d.username=r),placeholder:"用户名",size:"large","prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),s(f,{prop:"password"},{default:t(()=>[s(n,{modelValue:d.password,"onUpdate:modelValue":e[1]||(e[1]=r=>d.password=r),type:"password",placeholder:"密码",size:"large","prefix-icon":"Lock","show-password":"",onKeyup:Y(k,["enter"])},null,8,["modelValue"])]),_:1}),s(f,null,{default:t(()=>[s(C,{type:"primary",size:"large",class:"login-button cyber-button pulse",loading:v.value,onClick:k},{default:t(()=>[v.value?(b(),y("span",ne,e[9]||(e[9]=[o("i",{class:"loading-cyber"},null,-1),a(" 系统验证中... ")]))):(b(),y("span",ue," 🔐 启动系统 "))]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),o("div",ie,[o("p",null,[e[11]||(e[11]=a(" 需要访问权限？ ")),s(C,{type:"text",class:"register-link neon-text-secondary",onClick:e[2]||(e[2]=r=>l.value=!0)},{default:t(()=>e[10]||(e[10]=[a(" 申请权限 → ")])),_:1,__:[10]})]),e[12]||(e[12]=o("div",{class:"access-info"},[o("p",{class:"access-tip"},"🔒 安全连接已建立"),o("p",{class:"access-tip"},"⚡ 量子加密传输")],-1))])])]),s(N,{modelValue:l.value,"onUpdate:modelValue":e[8]||(e[8]=r=>l.value=r),title:"用户注册",width:"400px","before-close":B},{footer:t(()=>[o("span",de,[s(C,{onClick:e[7]||(e[7]=r=>l.value=!1)},{default:t(()=>e[14]||(e[14]=[a("取消")])),_:1,__:[14]}),s(C,{type:"primary",loading:w.value,onClick:q},{default:t(()=>e[15]||(e[15]=[a(" 注册 ")])),_:1,__:[15]},8,["loading"])])]),default:t(()=>[s(F,{ref_key:"registerFormRef",ref:_,model:u,rules:A,"label-width":"80px"},{default:t(()=>[s(f,{label:"用户名",prop:"username"},{default:t(()=>[s(n,{modelValue:u.username,"onUpdate:modelValue":e[3]||(e[3]=r=>u.username=r)},null,8,["modelValue"])]),_:1}),s(f,{label:"邮箱",prop:"email"},{default:t(()=>[s(n,{modelValue:u.email,"onUpdate:modelValue":e[4]||(e[4]=r=>u.email=r),type:"email"},null,8,["modelValue"])]),_:1}),s(f,{label:"姓名",prop:"full_name"},{default:t(()=>[s(n,{modelValue:u.full_name,"onUpdate:modelValue":e[5]||(e[5]=r=>u.full_name=r)},null,8,["modelValue"])]),_:1}),s(f,{label:"密码",prop:"password"},{default:t(()=>[s(n,{modelValue:u.password,"onUpdate:modelValue":e[6]||(e[6]=r=>u.password=r),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const ke=D(me,[["__scopeId","data-v-4cfa0fa5"]]);export{ke as default};
