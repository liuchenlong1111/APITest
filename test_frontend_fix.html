<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•é¡¹ç›®ä¸­å¿ƒä¿®å¤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            border-left: 4px solid #409eff;
            background: #f0f9ff;
        }
        .status-success {
            border-left-color: #67c23a;
            background: #f0f9f0;
        }
        .status-error {
            border-left-color: #f56c6c;
            background: #fef0f0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ é¡¹ç›®ä¸­å¿ƒä¿®å¤éªŒè¯</h1>
        <p>æµ‹è¯•å‰ç«¯é¡¹ç›®ä¸­å¿ƒé¡µé¢æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        
        <div id="test-results">
            <div class="test-item">
                <strong>æµ‹è¯•1ï¼šAPIè¿æ¥æµ‹è¯•</strong>
                <div id="api-test">æ­£åœ¨æµ‹è¯•...</div>
            </div>
            
            <div class="test-item">
                <strong>æµ‹è¯•2ï¼šæ•°æ®æ ¼å¼éªŒè¯</strong>
                <div id="format-test">æ­£åœ¨æµ‹è¯•...</div>
            </div>
            
            <div class="test-item">
                <strong>æµ‹è¯•3ï¼šé¡¹ç›®åˆ—è¡¨æ˜¾ç¤º</strong>
                <div id="list-test">æ­£åœ¨æµ‹è¯•...</div>
            </div>
        </div>
        
        <div style="margin-top: 20px;">
            <button onclick="openProjectCenter()" style="background: #409eff; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">
                æ‰“å¼€é¡¹ç›®ä¸­å¿ƒ
            </button>
        </div>
    </div>

    <script>
        async function testAPI() {
            try {
                const response = await fetch('http://localhost:8000/api/v1/projects/');
                const data = await response.json();
                
                // æµ‹è¯•1ï¼šAPIè¿æ¥
                const apiTest = document.getElementById('api-test');
                if (response.ok) {
                    apiTest.innerHTML = 'âœ… APIè¿æ¥æˆåŠŸ';
                    apiTest.parentElement.classList.add('status-success');
                } else {
                    apiTest.innerHTML = 'âŒ APIè¿æ¥å¤±è´¥';
                    apiTest.parentElement.classList.add('status-error');
                    return;
                }
                
                // æµ‹è¯•2ï¼šæ•°æ®æ ¼å¼éªŒè¯
                const formatTest = document.getElementById('format-test');
                if (Array.isArray(data) && data.every(item => 
                    item.hasOwnProperty('id') && 
                    item.hasOwnProperty('name') && 
                    item.hasOwnProperty('module_count') &&
                    item.hasOwnProperty('api_count'))) {
                    formatTest.innerHTML = 'âœ… æ•°æ®æ ¼å¼æ­£ç¡®ï¼ˆæ‰å¹³åŒ–æ ¼å¼ï¼‰';
                    formatTest.parentElement.classList.add('status-success');
                } else {
                    formatTest.innerHTML = 'âŒ æ•°æ®æ ¼å¼ä¸æ­£ç¡®';
                    formatTest.parentElement.classList.add('status-error');
                    return;
                }
                
                // æµ‹è¯•3ï¼šé¡¹ç›®åˆ—è¡¨æ˜¾ç¤º
                const listTest = document.getElementById('list-test');
                listTest.innerHTML = `âœ… å‘ç° ${data.length} ä¸ªé¡¹ç›®<br/>`;
                data.forEach(project => {
                    listTest.innerHTML += `ğŸ“ ${project.name} (${project.module_count}æ¨¡å—, ${project.api_count}æ¥å£)<br/>`;
                });
                listTest.parentElement.classList.add('status-success');
                
            } catch (error) {
                console.error('æµ‹è¯•å¤±è´¥:', error);
                document.getElementById('api-test').innerHTML = 'âŒ æµ‹è¯•å¼‚å¸¸: ' + error.message;
                document.getElementById('api-test').parentElement.classList.add('status-error');
            }
        }
        
        function openProjectCenter() {
            window.open('http://localhost:80/#/projects', '_blank');
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨æµ‹è¯•
        window.onload = testAPI;
    </script>
</body>
</html> 